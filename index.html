<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë‚˜ë§Œì˜ ì–¸ì–´ ìƒì„±ê¸°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      background: #f3f4f6;
      color: #111827;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    header {
      margin-bottom: 24px;
    }

    header h1 {
      margin: 0 0 8px;
      font-size: 1.8rem;
    }

    header p {
      margin: 0;
      color: #4b5563;
      font-size: 0.95rem;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-bottom: 16px;
    }

    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: #ffffff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.08);
    }

    .card h2 {
      margin: 0 0 12px;
      font-size: 1.1rem;
    }

    textarea {
      width: 100%;
      min-height: 140px;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      padding: 10px;
      resize: vertical;
      font-size: 0.95rem;
    }

    textarea:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 1px #3b82f6;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .btn-primary {
      background: #2563eb;
      color: white;
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #111827;
    }

    .btn-danger {
      background: #f97373;
      color: white;
    }

    .rules-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      gap: 8px;
      flex-wrap: wrap;
    }

    .rules-header h2 {
      margin: 0;
    }

    .rules-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }

    .rules-table th,
    .rules-table td {
      border-bottom: 1px solid #e5e7eb;
      padding: 6px;
      text-align: left;
    }

    .rules-table input {
      width: 100%;
      padding: 4px 6px;
      border-radius: 6px;
      border: 1px solid #e5e7eb;
      font-size: 0.87rem;
    }

    .rules-table input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 1px #3b82f6;
    }

    .rules-footer {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
      font-size: 0.8rem;
      color: #6b7280;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      background: #eff6ff;
      color: #1d4ed8;
    }

    .hint {
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ë‚˜ë§Œì˜ ì–¸ì–´ ìƒì„±ê¸°</h1>
      <p>
        ê·œì¹™ì„ ë§Œë“¤ì–´ì„œ ì¼ë°˜ ë¬¸ì¥ì„ ë‚˜ë§Œì˜ ì–¸ì–´ë¡œ ë³€í™˜í•˜ê±°ë‚˜, ë‹¤ì‹œ ë³µí˜¸í™”í•  ìˆ˜ ìˆëŠ” ë„êµ¬ì…ë‹ˆë‹¤.
        ê°„ë‹¨í•œ ì¹˜í™˜ ê·œì¹™ë¶€í„°, ì•ŒíŒŒë²³ ëœë¤ ì•”í˜¸ê¹Œì§€ ë§ˆìŒëŒ€ë¡œ ë§Œë“¤ì–´ ë³´ì„¸ìš”.
      </p>
    </header>

    <div class="grid">
      <!-- ì›ë³¸ í…ìŠ¤íŠ¸ -->
      <div class="card">
        <h2>ì›ë³¸ í…ìŠ¤íŠ¸</h2>
        <textarea
          id="inputText"
          placeholder="ì˜ˆì‹œ: ì˜¤ëŠ˜ ìƒˆë²½ 5ì‹œì— ì¼ì–´ë‚˜ì„œ ë‚˜ë§Œì˜ ì–¸ì–´ë¥¼ ë§Œë“¤ì—ˆë‹¤."
        ></textarea>
        <div class="hint">
          âœ¨ ìœ„ì— ë¬¸ì¥ì„ ì ê³ , ì˜¤ë¥¸ìª½ì—ì„œ ê·œì¹™ì„ ë§Œë“  ë’¤ ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ
          ë³€í™˜í•´ ë³´ì„¸ìš”.
        </div>
        <div class="btn-row" style="margin-top: 12px;">
          <button class="btn-primary" id="btnEncode">
            ğŸ” ì•”í˜¸í™” (Encode)
          </button>
          <button class="btn-secondary" id="btnDecode">
            ğŸ”“ ë³µí˜¸í™” (Decode)
          </button>
        </div>
      </div>

      <!-- ê²°ê³¼ í…ìŠ¤íŠ¸ -->
      <div class="card">
        <h2>ê²°ê³¼ í…ìŠ¤íŠ¸</h2>
        <textarea
          id="outputText"
          placeholder="ë³€í™˜ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."
          readonly
        ></textarea>
        <div class="btn-row" style="margin-top: 12px;">
          <button class="btn-secondary" id="btnCopy">
            ğŸ“‹ ê²°ê³¼ ë³µì‚¬
          </button>
          <button class="btn-secondary" id="btnSwap">
            ğŸ” ì…ë ¥ & ê²°ê³¼ ë°”ê¾¸ê¸°
          </button>
        </div>
      </div>
    </div>

    <!-- ê·œì¹™ í¸ì§‘ ì˜ì—­ -->
    <div class="card" style="margin-top: 16px;">
      <div class="rules-header">
        <h2>ì–¸ì–´ ë³€í™˜ ê·œì¹™</h2>
        <div class="btn-row">
          <button class="btn-secondary" id="btnAddRule">â• ê·œì¹™ ì¶”ê°€</button>
          <button class="btn-secondary" id="btnRandomAlphabet">
            ğŸ² ì•ŒíŒŒë²³ ëœë¤ ì–¸ì–´ ìƒì„±
          </button>
          <button class="btn-danger" id="btnClearRules">
            ğŸ§¹ ëª¨ë“  ê·œì¹™ ì‚­ì œ
          </button>
        </div>
      </div>

      <table class="rules-table">
        <thead>
          <tr>
            <th style="width: 35%;">ì›ë˜ ë¬¸ìì—´ (From)</th>
            <th style="width: 35%;">ë³€í™˜ ë¬¸ìì—´ (To)</th>
            <th style="width: 20%;">ì˜µì…˜</th>
            <th style="width: 10%;">ì‚­ì œ</th>
          </tr>
        </thead>
        <tbody id="rulesBody">
          <!-- ê·œì¹™ í–‰ì´ JSë¡œ ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
        </tbody>
      </table>

      <div class="rules-footer">
        <span class="badge">Tip</span>
        <span>
          ìœ„ì—ì„œ ì•„ë˜ ìˆœì„œëŒ€ë¡œ ê·œì¹™ì´ ì ìš©ë©ë‹ˆë‹¤. ê¸´ ë‹¨ì–´ ê·œì¹™ì„ ìœ„ì— ë‘ë©´
          ì˜ˆìƒì¹˜ ëª»í•œ ì¹˜í™˜ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </span>
      </div>
    </div>
  </div>

  <script>
    // ê·œì¹™ í…Œì´ë¸”ì˜ tbody
    const rulesBody = document.getElementById("rulesBody");

    // ë²„íŠ¼ ìš”ì†Œ
    const btnAddRule = document.getElementById("btnAddRule");
    const btnRandomAlphabet = document.getElementById("btnRandomAlphabet");
    const btnClearRules = document.getElementById("btnClearRules");
    const btnEncode = document.getElementById("btnEncode");
    const btnDecode = document.getElementById("btnDecode");
    const btnCopy = document.getElementById("btnCopy");
    const btnSwap = document.getElementById("btnSwap");

    const inputText = document.getElementById("inputText");
    const outputText = document.getElementById("outputText");

    // ê·œì¹™ í•œ í–‰ ì¶”ê°€
    function addRuleRow(fromValue = "", toValue = "") {
      const tr = document.createElement("tr");

      const tdFrom = document.createElement("td");
      const tdTo = document.createElement("td");
      const tdOption = document.createElement("td");
      const tdDelete = document.createElement("td");

      const inputFrom = document.createElement("input");
      inputFrom.type = "text";
      inputFrom.value = fromValue;
      inputFrom.placeholder = "ì˜ˆ: ê°€";

      const inputTo = document.createElement("input");
      inputTo.type = "text";
      inputTo.value = toValue;
      inputTo.placeholder = "ì˜ˆ: BA";

      tdFrom.appendChild(inputFrom);
      tdTo.appendChild(inputTo);

      // ì˜µì…˜: ëŒ€ì†Œë¬¸ì êµ¬ë¶„, ì „ì²´ ë‹¨ì–´ë§Œ ë“± (ì§€ê¸ˆì€ placeholderë¡œë§Œ)
      const optionSpan = document.createElement("span");
      optionSpan.textContent = "ë‹¨ìˆœ ì¹˜í™˜";
      optionSpan.style.fontSize = "0.8rem";
      optionSpan.style.color = "#6b7280";
      tdOption.appendChild(optionSpan);

      const btnDeleteRow = document.createElement("button");
      btnDeleteRow.textContent = "ì‚­ì œ";
      btnDeleteRow.className = "btn-danger";
      btnDeleteRow.style.fontSize = "0.8rem";
      btnDeleteRow.addEventListener("click", () => {
        tr.remove();
      });
      tdDelete.appendChild(btnDeleteRow);

      tr.appendChild(tdFrom);
      tr.appendChild(tdTo);
      tr.appendChild(tdOption);
      tr.appendChild(tdDelete);

      rulesBody.appendChild(tr);
    }

    // í˜„ì¬ ê·œì¹™ë“¤ì„ ë°°ì—´ë¡œ ê°€ì ¸ì˜¤ê¸°
    // [{from: "...", to: "..."}, ...]
    function getRules() {
      const rows = Array.from(rulesBody.querySelectorAll("tr"));
      return rows
        .map((row) => {
          const inputs = row.querySelectorAll("input");
          const from = inputs[0]?.value ?? "";
          const to = inputs[1]?.value ?? "";
          return { from, to };
        })
        .filter((rule) => rule.from !== "");
    }

    // ë¬¸ìì—´ ì¹˜í™˜ í•¨ìˆ˜ (ê°„ë‹¨ ë²„ì „)
    function applyRules(text, rules, direction = "encode") {
      let result = text;

      if (direction === "encode") {
        // from -> to
        rules.forEach((rule) => {
          if (!rule.from) return;
          const from = rule.from;
          const to = rule.to ?? "";
          result = result.split(from).join(to);
        });
      } else {
        // decode: ì—­ìˆœìœ¼ë¡œ to -> from
        const reversed = [...rules].reverse();
        reversed.forEach((rule) => {
          if (!rule.to) return;
          const from = rule.from ?? "";
          const to = rule.to;
          result = result.split(to).join(from);
        });
      }

      return result;
    }

    // ì•”í˜¸í™” ë²„íŠ¼ í´ë¦­
    btnEncode.addEventListener("click", () => {
      const text = inputText.value ?? "";
      const rules = getRules();
      const converted = applyRules(text, rules, "encode");
      outputText.value = converted;
    });

    // ë³µí˜¸í™” ë²„íŠ¼ í´ë¦­
    btnDecode.addEventListener("click", () => {
      const text = inputText.value ?? "";
      const rules = getRules();
      const converted = applyRules(text, rules, "decode");
      outputText.value = converted;
    });

    // ê²°ê³¼ ë³µì‚¬
    btnCopy.addEventListener("click", async () => {
      const text = outputText.value;
      if (!text) return;
      try {
        await navigator.clipboard.writeText(text);
        alert("ê²°ê³¼ í…ìŠ¤íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.");
      } catch (e) {
        alert("ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ë¸Œë¼ìš°ì € ê¶Œí•œ í™•ì¸)");
      }
    });

    // ì…ë ¥/ê²°ê³¼ swap
    btnSwap.addEventListener("click", () => {
      const temp = inputText.value;
      inputText.value = outputText.value;
      outputText.value = temp;
    });

    // ê·œì¹™ ì¶”ê°€ ë²„íŠ¼
    btnAddRule.addEventListener("click", () => {
      addRuleRow();
    });

    // ì•ŒíŒŒë²³ ëœë¤ ì–¸ì–´ ìƒì„±
    btnRandomAlphabet.addEventListener("click", () => {
      const alphabet = "abcdefghijklmnopqrstuvwxyz".split("");

      // í”¼ì…”â€“ì˜ˆì´ì¸  ì…”í”Œ
      const shuffled = [...alphabet];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }

      // ê¸°ì¡´ ê·œì¹™ ì œê±°
      rulesBody.innerHTML = "";

      // ì•ŒíŒŒë²³ ê·œì¹™ ìƒì„±
      alphabet.forEach((ch, idx) => {
        const from = ch;
        const to = shuffled[idx];
        addRuleRow(from, to);
      });
    });

    // ëª¨ë“  ê·œì¹™ ì‚­ì œ
    btnClearRules.addEventListener("click", () => {
      if (!confirm("ì •ë§ ëª¨ë“  ê·œì¹™ì„ ì‚­ì œí• ê¹Œìš”?")) return;
      rulesBody.innerHTML = "";
    });

    // ê¸°ë³¸ ì˜ˆì‹œ ê·œì¹™ ëª‡ ê°œ ë„£ì–´ì£¼ê¸°
    function initExampleRules() {
      addRuleRow("ì‚¬ë‘", "BODO");
      addRuleRow("ë‚˜", "DO");
      addRuleRow("ê°€", "BA");
    }

    // ì´ˆê¸°í™”
    initExampleRules();
  </script>
</body>
</html>
